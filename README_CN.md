# 字幕下载器 (Subtitles Downloader)

一个基于 Electron 的桌面应用程序，用于自动下载电影字幕。

## 功能特点

- 🎬 **支持多种视频格式**：avi, mp4, mkv, rmvb, rm, asf, divx, mpg, mpeg, mpe, wmv, vob
- 📁 **拖拽操作**：支持拖拽单个视频文件或包含视频的文件夹
- 🔍 **智能匹配**：使用字符串相似度算法自动匹配最合适的字幕
- 📥 **多源下载**：支持从 Shooter 和 Zimuku.net 两个字幕源下载
- ⚡ **批量处理**：支持批量下载多个视频的字幕
- 🎯 **自动保存**：字幕文件自动保存到视频文件所在目录
- ✅ **智能选择**：支持单个选择、全选/取消全选功能
- 📊 **状态显示**：实时显示文件状态和下载进度
- 🎨 **现代界面**：美观的用户界面，支持状态图标和颜色编码

## 安装说明

### 环境要求
- Node.js (推荐 v12 或更高版本)
- npm 或 yarn

### 安装步骤

1. 克隆项目到本地
```bash
git clone <repository-url>
cd Subtitles-Downloader
```

2. 安装依赖
```bash
npm install
```

3. 构建并运行应用
```bash
npm start
```

### 打包发布

```bash
npm run build
```

打包后的应用将生成在 `builds` 目录中。

## 使用说明

1. **启动应用**：运行 `npm start` 启动字幕下载器
2. **添加视频文件**：
   - 将视频文件拖拽到应用窗口
   - 或将包含视频文件的文件夹拖拽到应用窗口
3. **选择文件**：
   - 点击列表中的文件名来选择要下载字幕的视频
   - 使用 "全选" 按钮快速选择所有文件
   - 使用 "取消全选" 按钮取消所有选择
4. **下载字幕**：点击 "下载选中文件" 按钮开始下载
5. **查看状态**：
   - ⏳ 等待下载：文件已选择，等待开始下载
   - ✅ 下载完成：字幕已成功下载
   - ❌ 下载失败：字幕下载失败，将尝试备用源
6. **文件管理**：使用 "移除选中" 按钮删除不需要的文件

## 字幕源

### Shooter
- 主要字幕源
- 使用 `shooter` 库进行字幕搜索和下载
- 支持通过视频文件哈希值精确匹配字幕

### Zimuku.net
- 备用字幕源
- 当 Shooter 无法找到匹配字幕时自动切换
- 使用网页爬虫技术搜索和下载字幕

## 技术架构

### 前端技术
- **Electron**：跨平台桌面应用框架
- **React**：用户界面库
- **Bootstrap 3**：UI 样式框架
- **Webpack**：模块打包工具

### 核心依赖
- `cheerio`：服务器端 jQuery 实现，用于网页解析
- `superagent`：HTTP 请求库
- `string-similarity`：字符串相似度比较算法
- `shooter`：字幕下载库
- `request`：HTTP 请求库

## 开发说明

### 项目结构
```
Subtitles-Downloader/
├── main.js              # Electron 主进程
├── view.js              # React 前端组件
├── index.html           # 主页面
├── about.html           # 关于页面
├── webpack.config.js    # Webpack 配置
├── package.json         # 项目配置
└── assets/              # 资源文件
    └── images/          # 图标文件
```

### 开发命令
```bash
# 开发模式运行
npm start

# 仅构建前端代码
npm run webpack

# 打包应用
npm run package

# 构建并打包
npm run build
```

## 注意事项

1. **网络连接**：应用需要网络连接来访问字幕源
2. **文件权限**：确保应用有权限访问视频文件所在目录
3. **字幕质量**：字幕质量取决于字幕源，建议下载后检查字幕内容
4. **版权声明**：请遵守相关版权法律法规，仅下载合法授权的字幕
5. **安全提示**：开发环境中的安全警告是正常的，打包后的应用不会显示
6. **模块加载**：首次启动时会显示"正在加载模块..."，请耐心等待

## 常见问题

### Q: 为什么有些视频找不到字幕？
A: 可能的原因包括：
- 视频文件名不规范
- 字幕源中没有对应的字幕文件
- 网络连接问题

### Q: 下载的字幕文件在哪里？
A: 字幕文件会自动保存到视频文件所在的目录中。

### Q: 支持哪些操作系统？
A: 支持 Windows、macOS 和 Linux 系统。

### Q: 为什么应用启动时显示"正在加载模块..."？
A: 这是正常现象，应用需要加载 Node.js 模块来支持文件操作和网络请求功能。

### Q: 为什么下载按钮有时不显示？
A: 请确保已经选择了要下载的文件。只有选中文件后，下载按钮才会显示。

### Q: 开发环境中的安全警告是什么意思？
A: 这是 Electron 开发环境的正常警告，不影响应用功能。打包后的应用不会显示此警告。

## 许可证

本项目采用 CC0-1.0 许可证。

## 贡献

如果您对这个项目感兴趣或有任何建议，欢迎联系我们。

## 界面特色

### 现代化设计
- **直观的拖拽区域**：清晰的虚线边框和图标提示
- **智能状态显示**：使用 emoji 图标和颜色编码显示文件状态
- **响应式交互**：鼠标悬停效果和选中状态高亮
- **实时统计信息**：显示文件总数、已选择数量、已下载数量

### 便捷操作
- **一键全选**：快速选择所有文件进行批量操作
- **智能按钮**：按钮文本和状态根据当前情况自动调整
- **状态反馈**：下载进度和状态实时更新
- **文件管理**：支持移除不需要的文件
- **错误提示**：友好的错误消息和成功提示
- **进度显示**：实时显示下载进度和状态

## 更新日志

### v1.0.2 (最新)
- ✨ 全新现代化用户界面设计
- ✅ 添加全选/取消全选功能
- 📊 增强状态显示和进度反馈
- 🎨 优化视觉体验和交互设计
- 🔧 修复文件选择功能问题
- 📱 改进响应式布局和按钮状态
- 🔒 修复安全漏洞，升级依赖包
- 🚨 改进错误处理和用户提示
- 📈 实现真实下载进度显示
- 🛠️ 修复 Electron 菜单模板错误
- 🔧 修复 Node.js 模块加载问题
- 🎯 修复下载按钮显示逻辑

### v1.0.1
- 初始版本发布
- 支持基本的字幕下载功能
- 集成 Shooter 和 Zimuku.net 字幕源
